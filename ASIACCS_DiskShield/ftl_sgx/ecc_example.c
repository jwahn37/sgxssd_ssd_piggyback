#include "ecc.h"
#include <stdio.h>
#include <string.h>

int main()
{
    uint8_t text[] = "Hello world!!\n";
	SHA256_CTX ctx;

    sgx_ec256_public_t p_publicKey;
    sgx_ec256_signature_t p_signature;
    sgx_ec256_private_t p_privateKey;

 //   sgx_sha256_hash_t p_hash = {0x11, 0x7f, 0xfc, 0xa3, 0x60, 0x29, 0xeb, 0xdc, 0x8d, 0xed, 0x1e, 0x27, 0xed, 0xc4, 0x29, 0xf8, 0xea, 0x17, 0xc7, 0x51, 0x7a, 0xd7, 0x32, 0x91, 0x4b, 0x72, 0xbc, 0x66, 0x2e, 0xe9, 0x42, 0x4e};
    sgx_sha256_hash_t p_hash;
    sgx_sha256_hash_t p_hash2 = {0x11, 0x7f, 0xfc, 0xa3, 0x60, 0x29, 0xeb, 0xdc, 0x8d, 0xed, 0x1e, 0x27, 0xed, 0xc4, 0x29, 0xf8, 0xea, 0x17, 0xc7, 0x51, 0x7a, 0xd7, 0x32, 0x91, 0x4b, 0x72, 0xbc, 0x66, 0x2e, 0xe9, 0x42, 0x4e};
    uint8_t gx[SGX_ECP256_KEY_SIZE] = {
        0xbd, 0x76, 0xb8, 0x22, 0x34, 0xd1, 0x69, 0xb, 0x57, 0xa1, 0x1, 0xb3, 0x8d, 0xa8, 0x19, 0x59, 0xb0, 0x83, 0x5f, 0xa8, 0x88, 0xdc, 0x83, 0xe9, 0x2f, 0x8b, 0x34, 0xa8, 0x47, 0x52, 0xc, 0xc6
    };
    uint8_t gy[SGX_ECP256_KEY_SIZE] = { 
      0x49, 0x30, 0x84, 0xe7, 0x7a, 0x31, 0x9c, 0x98, 0x7d, 0xae, 0xfb, 0xa4, 0xe5, 0x85, 0xaf, 0x8a, 0x70, 0xc5, 0x79, 0xde, 0x78, 0xff, 0xd0, 0xc4, 0xb4, 0x28, 0xba, 0x7a, 0x59, 0xd5, 0x6d, 0xce
    };
    uint32_t x[SGX_NISTP_ECP256_KEY_SIZE]={
        0xa26d5f7c, 0x714fa352, 0x5a97c23f, 0xa6528921, 0xca26e7c2, 0xdaf0df50, 0x1d81264f, 0xeefaeb4c
        };
    uint32_t y[SGX_NISTP_ECP256_KEY_SIZE]={
        0x29fecc67, 0xf04cd792, 0x4b0309b, 0xe9ce9746, 0x6309c23e, 0x16c9b694, 0xa50735ad, 0xaef180b8
        };
 
    uint8_t r[SGX_ECP256_KEY_SIZE] = {0xa0, 0xa4, 0xca, 0x42, 0x3c, 0xae, 0x5a, 0x34, 0x44, 0x22, 0xed, 0x27, 0x2c, 0x15, 0xa6, 0xec, 0xad, 0x9b, 0xa7, 0x94, 0xeb, 0x8e, 0x14, 0xe5, 0x10, 0xa5, 0x40, 0xfd, 0x7a, 0xdb, 0xc9, 0x7d};
    int i, temp;
    int verify;
    memcpy(p_publicKey.gx, gx, sizeof(gx));
    memcpy(p_publicKey.gy, gy, sizeof(gy));
    memcpy(p_signature.x, x, sizeof(x));
    memcpy(p_signature.y, y, sizeof(y));
    memcpy(p_privateKey.r, r, sizeof(r));
   // p_publickey.gx = gx;
   // p/_public
    
    //ecdsa_sign(const uint8_t p_privateKey.r, const uint8_t p_hash[ECC_BYTES], uint8_t p_signature[ECC_BYTES*2])
    //for(i=0; i<)
    
    sha256_init(&ctx);
    sha256_update(&ctx, text, 15);
	sha256_final(&ctx, p_hash);

    printf("SHA-256 tests: %s\n",  !memcmp(hash1, buf, SHA256_BLOCK_SIZE) ? "SUCCEEDED" : "FAILED");

    verify = ecdsa_verify(p_publicKey, p_hash, p_signature);
    if(verify)
        printf("Verification is SUCCESS!!!!\n");
    else
        printf("Verfication is failed......\n");
  //  printf("verfiy? : %d\n", verify);
}